{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst shopTitle = document.querySelector('.shopping-list-title');\n\nfunction queryLocalStorage() {\n  return JSON.parse(localStorage.getItem('addBook'));\n}\n\nfunction rendMarkup(elements) {\n  removeEmptyMarkup();\n  const markup = queryLocalStorage()\n    .map(book => {\n      return `<li class=\"shoppinglist-book\" id=\"${book._id}\">\n          <img\n            class=\"shoppinglist-book-image\"\n            src=\"${book.book_image}\"\n            alt=\"book image\"\n          />\n          <div class=\"shoppinglist-total-div\">\n            <div class=\"shoppinglist-tb-div\">\n              <div class=\"shoppinglist-titcat-div\">\n                <h3 class=\"shoppinglist-book-title\">${book.title}</h3>\n                <p class=\"shoppinglist-book-category\">${book.list_name}</p>\n              </div>\n\n              <button\n                type=\"button\"\n                class=\"shoppinglist-book-deletebutton\"\n              ></button>\n            </div>\n\n            <div class=\"shoppinglist-desauthorlink\">\n              <p class=\"shoppinglist-book-description\">${book.description}</p>\n\n              <div class=\"shoppinglist-low-div\">\n                <p class=\"shoppinglist-book-author\">${book.author}</p>\n                <ul class=\"shoppinglist-book-low-ul\">\n                  <li class=\"shoppinglist-book-low-li-amazon\">\n                    <a\n                      class=\"shopping-amazon-link\"\n                      href=\"${book.amazon_product_url}\"\n                      target=\"_blank\"\n                    >\n                      <img\n                        class=\"shopping-listamazon-img\"\n                        src=\"./img/amazon.png\"\n                        alt=\"logoAmazon\"\n                      />\n                    </a>\n                  </li>\n                  <li class=\"shoppinglist-book-low-li-apple\">\n                    <a\n                      class=\"shopping-apple-link\"\n                      href=\"${book.buy_links[1].url}\"\n                      target=\"_blank\"\n                    >\n                      <img\n                        class=\"shopping-apple-img\"\n                        src=\"./img/apple.png\"\n                        alt=\"logo Apple books\"\n                      />\n                    </a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </li>`;\n    })\n    .join('');\n  shopTitle.insertAdjacentHTML('afterend', `<ul class=\"books\"></ul>`);\n  document.querySelector('.books').innerHTML = markup;\n}\n\nfunction addEmptyMarkup() {\n  if (document.querySelector('.books')) {\n    document.querySelector('.books').remove();\n  }\n\n  const emptyMarkup = `<p class=\"shopping-list-text\">\n            This page is empty, add some books and proceed to order.\n          </p>\n              <img\n                class=\"shopping-list-img\"\n                src=\"./img/books.png\"\n                alt=\"a lot of books\"\n              />`;\n  shopTitle.insertAdjacentHTML('afterend', emptyMarkup);\n  iziToast.info({\n    message: 'The list of books is empty.',\n    timeout: 3000,\n    position: 'topRight',\n  });\n}\n\nfunction removeEmptyMarkup() {\n  if (document.querySelector('.shopping-list-img')) {\n    document.querySelector('.shopping-list-img').remove();\n    document.querySelector('.shopping-list-text').remove();\n  }\n}\n\ndocument.querySelector('.shopping-list').addEventListener('click', event => {\n  event.preventDefault();\n  if (event.target.nodeName == 'BUTTON') {\n    const bookId = event.target.closest('li').getAttribute('id');\n    console.log(bookId);\n    const newArray = queryLocalStorage().filter(obj => obj._id !== bookId);\n    addtoLS(newArray);\n    const deleteElementLi = document.querySelector(`li[id=\"${bookId}\"]`);\n    deleteElementLi.remove();\n  }\n  if (queryLocalStorage().length === 0) {\n    addEmptyMarkup();\n  }\n});\n\nif (queryLocalStorage() && queryLocalStorage().length > 0) {\n  rendMarkup(queryLocalStorage());\n} else {\n  addEmptyMarkup();\n}\n\n// технический код для отрисовки лишек\n\nlet idArray = [];\nlet firstArray = [];\n\nasync function getBooks () {\n  const res = await axios.get(\n    'https://books-backend.p.goit.global/books/top-books'\n  );\n  firstArray = res.data;\n\nfor (let y = 0; y <= 5; y += 1) {\n  for (let i = 0; i <= 4; i += 1) {\n    idArray.push(firstArray[y].books[i]._id);\n  }\n}\n  // console.log(firstArray);\n};\n\ngetBooks()\n\n// for (let y = 0; y <= 5; y += 1) {\n//   for (let i = 0; i <= 4; i += 1) {\n//     idArray.push(firstArray[y].books[i]._id);\n//   }\n// }\n// console.log(idArray);\n\nlet inLocalStorage = [];\n\nlet f;\nasync function setLS() {\n  for (let i = 0; i < idArray.length; i += 4) {\n    // console.log(idArray[i]);\n    const result = await axios.get(\n      `https://books-backend.p.goit.global/books/${idArray[i]}`\n    );\n    inLocalStorage.push(result.data);\n  }\n  localStorage.setItem('addBook', JSON.stringify(inLocalStorage));\n  rendMarkup(queryLocalStorage());\n}\n\n// setLS();\n\ndocument.querySelector('.techbutton').addEventListener('click', onTechbutton);\nfunction onTechbutton() {\n  setLS();\n}\n\ndocument.querySelector(\".techbuttondel\").addEventListener(\"click\", onRemoveButton);\nfunction onRemoveButton() {\n  localStorage.removeItem(\"addBook\")\n}\n\n\n\n// console.log(booksArray);\n\n// '643282b1e85766588626a085';\n// const t = '643282b1e85766588626a0ba';\n// const result = await axios.get(\n//   `https://books-backend.p.goit.global/books/${t}`\n// );\n// console.log(result.data);\n// console.log(inStorage);\n// console.log(JSON.stringify(inStorage));\n\n// const LOCAL_STORAGE_KEY = 'addBook';\n// localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(inStorage[0]));\n\n// 643282b1e85766588626a0ba\n\n// const shopObject = {\n//  const book_image:\n//     'https://storage.googleapis.com/du-prd/books/images/9780385547345.jpg',\n//   title: 'LESSONS IN CHEMISTRY',\n//   list_name: 'Audio Fiction',\n//   description:\n//     'A scientist and single mother living in California in the 1960s becomes a star on a TV cooking show.',\n//   author: 'Bonnie Garmus',\n//   amazonUrl: 'https://www.amazon.com/dp/038554734X?tag=NYTBSREV-20',\n//   appleBooksUrl: 'https://goto.applebooks.apple/9780593507537?at=10lIEQ',\n//   id: '643282b1e85766588626a085',\n// };\nconst fromLS = JSON.parse(localStorage.getItem('addBook'));\n// console.log(fromLS);\n\n// function queryLocalStorage() {\n//   return JSON.parse(localStorage.getItem('addBook'));\n// }\n\nfunction addtoLS(newArray) {\n  localStorage.setItem('addBook', JSON.stringify(newArray));\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// // Описаний у документації\n// import iziToast from 'izitoast';\n// // Додатковий імпорт стилів\n// import 'izitoast/dist/css/iziToast.min.css';\n\n// import fetchServer from './js/pixabay-api';\n\n// import svgError from '/img/bi_x-octagon.svg';\n\n// import renderFunctions from './js/render-functions';\n\n// let searchText;\n// let pageNumber;\n// let maxPage;\n// const perPage = 15;\n// const formSubmit = document.querySelector('.form');\n// formSubmit.addEventListener('submit', onSubmit);\n// const LoadButton = document.querySelector('.load-button');\n// LoadButton.addEventListener('click', onLoadButton);\n\n// async function onSubmit(event) {\n//   searchText = event.target.elements.searchInput.value.trim();\n//   renderFunctions.hideLoadButton();\n//   event.preventDefault();\n//   renderFunctions.removeMarkup();\n//   event.target.reset();\n\n//   if (searchText) {\n//     renderFunctions.setLoader();\n//     pageNumber = 1;\n\n//     try {\n//       const data = await fetchServer(searchText, pageNumber, perPage);\n\n//       if (data.hits.length === 0) {\n//         renderFunctions.removeLoader();\n//         iziToast.error({\n//           timeout: 3000,\n//           message:\n//             'Sorry, there are no images matching your search query. Please try again!',\n//           maxWidth: '432px',\n//           messageColor: '#fff',\n//           messageSize: '16px',\n//           messageLineHeight: '1.5',\n//           backgroundColor: '#ef4040',\n//           position: 'topRight',\n//           titleColor: '#fff',\n//           titleSize: '16px',\n//           titleLineHeight: '1.5',\n//           iconUrl: svgError,\n//         });\n//         return;\n//       } else {\n//         maxPage = Math.ceil(data.totalHits / perPage);\n//         renderFunctions.renderMarkup(data.hits);\n//       }\n//     } catch {\n//       console.log('Mistake from server');\n//     }\n\n//     renderFunctions.removeLoader();\n//     renderFunctions.loadButtonStatus(pageNumber, maxPage);\n//   }\n// }\n\n// async function onLoadButton() {\n//   renderFunctions.setLoader();\n//   pageNumber += 1;\n\n//   const data = await fetchServer(searchText, pageNumber, perPage);\n\n//   renderFunctions.renderMarkup(data.hits);\n//   renderFunctions.removeLoader();\n//   renderFunctions.loadButtonStatus(pageNumber, maxPage);\n//   if (pageNumber >= maxPage) {\n//     iziToast.info({\n//       timeout: 3000,\n//       message: \"We're sorry, but you've reached the end of search results.\",\n//       position: 'topRight',\n//     });\n//   }\n//   window.scrollBy({\n//     behavior: 'smooth',\n//     top:\n//       2 *\n//       document.querySelector('.gallery-item').getBoundingClientRect().height,\n//   });\n// }\n"],"names":["shopTitle","queryLocalStorage","rendMarkup","elements","removeEmptyMarkup","markup","book","addEmptyMarkup","emptyMarkup","iziToast","event","bookId","newArray","obj","addtoLS","idArray","firstArray","getBooks","axios","y","i","inLocalStorage","setLS","result","onTechbutton","onRemoveButton"],"mappings":"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"}